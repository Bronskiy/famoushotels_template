{layout="includes/_wrapper"}
{exp:switchee variable="{segment_2}" parse="inward"}

{case value="|category|#P([0-9]+)#"}
<section class="content books">
	<div class="container">
		<div class="col-md-8">
			<div class="row">
				{exp:channel:entries channel="books" disable="member_data" limit="12" cache="yes" refresh="576" paginate="bottom"}
				<div class="col-md-6">
					<div class="grid-box">
						<div class="grid-post">
							<div class="grid-post-header">
								{if book_image}
								<a href="{url_title_path='books'}"><img src="{book_image}" alt="{title}"></a>
								{if:else}
								<a href="{url_title_path='books'}"><img src="http://via.placeholder.com/330x304" alt="{title}"></a>
								{/if}
								{categories limit="1"}<a href="/books/category/{category_url_title}"><span class="category">{category_name}</span></a>{/categories}
							</div>
							<div class="grid-post-content">
								<h2 class="grid-post-title"><a href="{url_title_path='books'}">{title}</a></h2>
								{if book_blurb}{exp:snippet total="200" word="true" ellipsis="..."}{book_blurb}{/exp:snippet} <a href="{url_title_path='books'}">Read more</a>{/if}
							</div>
							<div class="post-bottom clearfix">
								<span class="grid-read-more"><a href="{url_title_path='books'}">Add to Cart</a></span>
							</div>
						</div>
					</div>
				</div>
				{if count%2 == 0}
				<div class="clearfix"></div>
				{/if}
				{paginate}
				<div class="clearfix"></div>
				<div class="page-numbers">
					{pagination_links}
					<ul>
						{previous_page}
						<li class="previous-page"><a href="{pagination_url}"><i class="fa fa-angle-double-left"></i></a></li>
						{/previous_page}

						{page}
						<li><a href="{pagination_url}" class="page-number {if current_page}active{/if}"><span>{pagination_page_number}</span></a></li>
						{/page}

						{next_page}
						<li class="next-page"><a href="{pagination_url}"><i class="fa fa-angle-double-right"></i></a></li>
						{/next_page}
					</ul>
					{/pagination_links}
				</div>
				{/paginate}
				{/exp:channel:entries}
			</div>
		</div>
		{embed="includes/_sidebar" section_var="{segment_1}"}
	</div>
</section>
{/case}

{case value="tags"}
<section class="content books">
	<div class="container">

		<div class="col-md-8">
			<div class="row">
				<div class="col-md-12">
							<h1 class="normal-post-title">Entries tagged with: {exp:tag:tag_name tag="{segment_3}" case="title"}</h1>
						</div>
						{exp:tag:entries
						    tag="{segment_3}"
						    inclusive="yes"
						    orderby="title" sort="asc"
						    limit="20"
						    paginate="bottom"
						}
				<div class="col-md-6">
					<div class="grid-box">
						<div class="grid-post">
							<div class="grid-post-header">
								{if book_image}
								<a href="{url_title_path='books'}"><img src="{book_image}" alt="{title}"></a>
								{if:else}
								<a href="{url_title_path='books'}"><img src="http://via.placeholder.com/330x304" alt="{title}"></a>
								{/if}
								{categories limit="1"}<a href="/books/category/{category_url_title}"><span class="category">{category_name}</span></a>{/categories}
							</div>
							<div class="grid-post-content">
								<h2 class="grid-post-title"><a href="{url_title_path='books'}">{title}</a></h2>
								{if book_blurb}{exp:snippet total="200" word="true" ellipsis="..."}{book_blurb}{/exp:snippet} <a href="{url_title_path='books'}">Read more</a>{/if}
							</div>
							<div class="post-bottom clearfix">
								<span class="grid-read-more"><a href="{url_title_path='books'}">Add to Cart</a></span>
							</div>
						</div>
					</div>
				</div>
				{if count%2 == 0}
				<div class="clearfix"></div>
				{/if}
				{tag_paginate}
				<div class="clearfix"></div>
				<div class="page-numbers">
					{tag_pagination_links}
					<ul>
						{previous_page}
						<li class="previous-page"><a href="{pagination_url}"><i class="fa fa-angle-double-left"></i></a></li>
						{/previous_page}

						{page}
						<li><a href="{pagination_url}" class="page-number {if current_page}active{/if}"><span>{pagination_page_number}</span></a></li>
						{/page}

						{next_page}
						<li class="next-page"><a href="{pagination_url}"><i class="fa fa-angle-double-right"></i></a></li>
						{/next_page}
					</ul>
					{/tag_pagination_links}
				</div>
				{/tag_paginate}
				{/exp:tag:entries}
			</div>
		</div>
		{embed="includes/_sidebar" section_var="{segment_1}"}
	</div>
</section>
{/case}

{case value="#P([0-9]+)#"}
Content to show
{/case}

{case default="Yes"}
<section class="content single-post-content books">
	<div class="container">
		{exp:channel:entries channel="books" disable="categories|member_data|pagination" cache="yes" refresh="576"}
		<div class="col-md-8 normal-box">
			<div class="row">
				<div class="col-md-12">
					<h1 class="normal-post-title">{title}</h1>
				</div>
				<div class="col-md-6">
					<div class=" single-post-box">
						<div class="normal-post">
							{if book_image}
							<div class="normal-post-header">
								<img src="{book_image}" alt="{title}">
							</div>
							{/if}
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="single-post-box">
						<div class="normal-post">
							<div class="normal-post-content">
								<div class="properties">
									{if author_name}<div class="row"><div class="col-md-4 name"><h5>Author</h5></div><div class="col-md-8"><p>{author_name}</p></div></div>{/if}
									{if pages}<div class="row"><div class="col-md-4 name"><h5>Pages</h5></div><div class="col-md-8"><p>{pages}</p></div></div>{/if}
									{if binding}<div class="row"><div class="col-md-4 name"><h5>Binding</h5></div><div class="col-md-8"><p>{binding}, laminated jacket</p></div></div>{/if}
									{if acessories}<div class="row"><div class="col-md-4 name"><h5>Pages</h5></div><div class="col-md-8"><p>{acessories}</p></div></div>{/if}
									<div class="row"><div class="col-md-4 name"><h5>ISBN</h5></div><div class="col-md-8"><p>{if isbn && isbn_13}{isbn}, {isbn_13}{if:elseif isbn || isbn_13}{isbn}{isbn_13}{if:else}0-0000000-00-0{/if}</p></div></div>
									{if width || height || weight}<div class="row"><div class="col-md-4 name"><h5>Properties</h5></div><div class="col-md-8"><p>{if width && height}{width} x {height} mm{/if}{if weight}, {weight} g{/if}</p></div></div>{/if}
									{if other_languages != "None"}<div class="row"><div class="col-md-4 name"><h5>Also available in</h5></div><div class="col-md-8"><p>{other_languages}</p></div></div>{/if}
								</div>
								{exp:simple_commerce:purchase entry_id="{entry_id}" success="site/success" cancel="site/index"}
								<div class="add-to-cart">
									<p class="price">Price: <span>${item_sale_price}</span></p>
									<a class="cart-button" href="{add_to_cart_url}">Add to cart</a>
								</div>
								{/exp:simple_commerce:purchase}
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-12">
					<div class="single-post-box">
						<div class="normal-post">
							<div class="normal-post-content">
								{book_blurb}
							</div>
						</div>
					</div>
					<div class="post-footer clearfix">
						<div class="post-tags">
							<div class="post-tags-list">
								<ul>
									{exp:tag:tags
											entry_id="{entry_id}"
											orderby="tag_name" sort="asc"
											limit="10"
									}
									<li><a href="{path='books/tags'}/{websafe_tag}"><span class="tag">{tag}</span></a></li>
									{/exp:tag:tags}
								</ul>
							</div>
						</div>
						{/exp:channel:entries}

						<div class="widget-title">
							<h3>Related Books</h3>
						</div>
						{exp:tag:related_entries
    channel="books"
    orderby="relevance" sort="desc"
    limit="5"
    paginate="bottom"
}

    <h3><a href="{url_title_path='books'}">{title}</a></h3>
    <p>Relevance: {tag_relevance} matches ({tag_relevance_percent}%)</p>
    <p>{book_blurb}</p>

    {tag_paginate}
    <ul class="pagination">
        {tag_pagination_links}
            {first_page}
                <li><a href="{pagination_url}">First</a></li>
            {/first_page}
            {previous_page}
                <li><a href="{pagination_url}">&laquo; Previous</a></li>
            {/previous_page}
            {page}
                <li{if current_page} class="active"{/if}><a href="{pagination_url}">{pagination_page_number}</a></li>
            {/page}
            {next_page}
                <li><a href="{pagination_url}">Next &raquo;</a></li>
            {/next_page}
            {last_page}
                <li><a href="{pagination_url}">Last</a></li>
            {/last_page}
        {/tag_pagination_links}
    </ul>
    {/tag_paginate}

{/exp:tag:related_entries}
						<div class="col-md-6">
							<div class="small-news">
								<img src="http://via.placeholder.com/80x80" alt="">
								<span class="category">GIFTS</span>
								<span class="small-date">Jan 12, 2017</span>
								<h4 class="small-news-title"><a href="#">Lovely Flovers for Girls</a></h4>
								<span class="small-read-more"><a href="#">Prev Post</a></span>
							</div>
						</div>
						<div class="col-md-6">
							<div class="small-news">
								<img src="http://via.placeholder.com/80x80" alt="">
								<span class="category">HEALT</span>
								<span class="small-date">Jan 12, 2017</span>
								<h4 class="small-news-title"><a href="#">You Should Eat This</a></h4>
								<span class="small-read-more"><a href="#">Next Post</a></span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		{embed="includes/_sidebar" section_var="{segment_1}"}
	</div>
</section>
{/case}

{/exp:switchee}
